(function(r,q){if("object"===typeof exports&&"object"===typeof module)module.exports=q(require("jQuery"));else if("function"===typeof define&&define.amd)define(["jQuery"],q);else{var l="object"===typeof exports?q(require("jQuery")):q(r.jQuery),h;for(h in l)("object"===typeof exports?exports:r)[h]=l[h]}})(this,function(r){return function(q){function l(e){if(h[e])return h[e].exports;var p=h[e]={exports:{},id:e,loaded:!1};q[e].call(p.exports,p,p.exports,l);p.loaded=!0;return p.exports}var h={};l.m=q;
l.c=h;l.p="";return l(0)}([function(q,l,h){var e,p,r=[].indexOf||function(b){for(var a=0,c=this.length;a<c;a++)if(a in this&&this[a]===b)return a;return-1};e=h(1);h(2);l.Anno=function(){function b(a){var c,d,k;a.__proto__===Array.prototype?(d=a.shift(),k=a):d=a;d instanceof b&&console.warn("Anno constructor parameter is already an Anno object.");null==d&&console.warn("new Anno() created with no options. It's recommended to supply at least target and content.");for(c in d)"chainTo"!==c&&"start"!==
c&&"show"!==c&&"hide"!==c&&"hideAnno"!==c&&"chainSize"!==c&&"chainIndex"!==c&&"version"!==c||console.warn("Anno: Overriding '"+c+"' is not recommended. Can you override a delegated function instead?");for(c in d)a=d[c],this[c]=a;0<(null!=k?k.length:void 0)&&this.chainTo(new b(k))}b.setDefaults=function(a){var c,d,k;k=[];for(c in a)d=a[c],k.push(b.prototype[c]=d);return k};b.prototype.chainTo=function(a){null!=a?null==this._chainNext?(this._chainNext=a instanceof b?a:new b(a),this._chainNext._chainPrev=
this):this._chainNext.chainTo(a):console.error("Can't chainTo a null object.");return this};b.prototype._chainNext=null;b.prototype._chainPrev=null;b.chain=function(a){console.warn("Anno.chain([...]) is deprecated. Use `new Anno([...])` instead.");return new b(a)};b.prototype.chainSize=function(){return null!=this._chainNext?this._chainNext.chainSize():1+this.chainIndex()};b.prototype.chainIndex=function(a){var c;return null!=a?(c=function(a,k,b){var g;if(null!=a){g=a.chainIndex();if(0<=g&&g<k)return c(a._chainNext,
k,b);if(k<g&&g<=b)return c(a._chainPrev,k,b);if(g===k)return a}else return console.error("Couldn't switch to index '"+k+"'. Chain size "+("is '"+b+"'"))})(this,a,this.chainSize()):null!=this._chainPrev?1+this._chainPrev.chainIndex():0};b.prototype.show=function(){var a,c;a=this.targetFn();null!=this._annoElem&&console.warn("Anno elem for '"+this.target+"' has already been generated.  Did you call show() twice?");this._annoElem=this.annoElem();this.emphasiseTarget();this.showOverlay();a.after(this._annoElem);
this._annoElem.addClass("anno-target-"+this.arrowPositionFn());this.positionAnnoElem();setTimeout(function(a){return function(){return a._annoElem.removeClass("anno-hidden")}}(this),50);a.scrollintoview();setTimeout(function(a){return function(){return a._annoElem.scrollintoview()}}(this),300);c=this._annoElem.find("button").last();this.rightArrowClicksLastButton&&c.keydown(function(a){if(39===a.keyCode)return e(this).click()});this.autoFocusLastButton&&0===a.find(":focus").length&&c.focus();this._returnFromOnShow=
this.onShow(this,a,this._annoElem);return this};b.prototype.start=function(){return this.show()};b.prototype.rightArrowClicksLastButton=!0;b.prototype.autoFocusLastButton=!0;b.prototype.onShow=function(a,c,d){};b.prototype.hide=function(){this.hideAnno();setTimeout(this.hideOverlay,50);return this};b.prototype.hideAnno=function(){null!=this._annoElem?(this._annoElem.addClass("anno-hidden"),this.deemphasiseTarget(),this.onHide(this,this.targetFn(),this._annoElem,this._returnFromOnShow),function(a){return setTimeout(function(){return a.remove()},
300)}(this._annoElem),this._annoElem=null):console.warn("Can't hideAnno() for '"+this.target+"' when @_annoElem is null.  Did you call hideAnno() twice?");return this};b.prototype.onHide=function(a,c,d,b){};b.prototype.switchTo=function(a){if(null!=a)return this.hideAnno(),a.show();console.warn("Can't switchTo a null object. Hiding instead.");return this.hide()};b.prototype.switchToChainNext=function(){return this.switchTo(this._chainNext)};b.prototype.switchToChainPrev=function(){return this.switchTo(this._chainPrev)};
b.prototype.target="h1";b.prototype.targetFn=function(){var a;if("string"===typeof this.target)return a=e(this.target).filter(":not(.anno-placeholder)"),0===a.length&&console.error("Couldn't find Anno.target '"+this.target+"'."),1<a.length&&console.warn("Anno target '"+this.target+"' matched "+a.length+" elements. Targeting the first one."),a.first();if(this.target instanceof jQuery)return 1<this.target.length&&console.warn("Anno jQuery target matched "+this.target.length+" elements. Targeting the first one."),
this.target.first();if(this.target instanceof HTMLElement)return e(this.target);if("function"===typeof this.target)return this.target();console.error("Unrecognised Anno.target. Please supply a jQuery selector string, a jQuery object, a raw DOM element or a function returning a jQuery element. target:");return console.error(this.target)};b.prototype.annoElem=function(){this._annoElem=e("<div class='anno anno-hidden "+this.className+"'>\n<div class='anno-inner'>  <div class='anno-arrow'></div>  </div>\n</div>");
this._annoElem.find(".anno-inner").append(this.contentElem()).append(this.buttonsElem());return this._annoElem};b.prototype._annoElem=null;b.prototype.className="";b.prototype.content="Lorem ipsum dolor sit amet, consectetur adipiscing elit.";b.prototype.contentFn=function(){return this.content};b.prototype.contentElem=function(){return e("<div class='anno-content'>"+this.contentFn()+"</div>")};b.prototype.showOverlay=function(){var a;return 0===e(".anno-overlay").length?(e("body").append(a=this.overlayElem().addClass("anno-hidden")),
setTimeout(function(){return a.removeClass("anno-hidden")},10)):e(".anno-overlay").replaceWith(this.overlayElem())};b.prototype.overlayElem=function(){return e("<div class='anno-overlay "+this.overlayClassName+"'></div>").click(function(a){return function(c){return a.overlayClick.call(a,a,c)}}(this))};b.prototype.overlayClassName="";b.prototype.overlayClick=function(a,c){return a.hide()};b.prototype.hideOverlay=function(){e(".anno-overlay").addClass("anno-hidden");return setTimeout(function(){return e(".anno-overlay").remove()},
300)};b.prototype.emphasiseTarget=function(a){var c,d,b;null==a&&(a=this.targetFn());this._undoEmphasise=[];a.closest(":scrollable").on("mousewheel",function(a){a.preventDefault();return a.stopPropagation()});this._undoEmphasise.push(function(a){return a.closest(":scrollable").off("mousewheel")});"static"===a.css("position")&&(a.after(c=a.clone().addClass("anno-placeholder")),function(a){return function(d){return a._undoEmphasise.push(function(){return d.remove()})}}(this)(c),d=a.prop("style").position,
function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({position:d})})}}(this)(d),a.css({position:"absolute"}),a.outerWidth()!==c.outerWidth()&&(d=a.prop("style").width,function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({width:d})})}}(this)(d),a.css("width",c.outerWidth())),a.outerHeight()!==c.outerHeight()&&(d=a.prop("style").height,function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({height:d})})}}(this)(d),
a.css("height",c.outerHeight())),c=c.position(),b=a.position(),b.top!==c.top&&(d=a.prop("style").top,function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({top:d})})}}(this)(d),a.css("top",c.top)),b.left!==c.left&&(d=a.prop("style").left,function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({left:d})})}}(this)(d),a.css("left",c.left)));if("rgba(0, 0, 0, 0)"===a.css("backgroundColor")||"transparent"===a.css("backgroundColor"))console.warn("Anno.js target '"+
this.target+"' has a transparent bg; filling it white temporarily."),c=a.prop("style").background,function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({background:d})})}}(this)(c),a.css({background:"white"});c=a.prop("style").zIndex;(function(a){return function(d){return a._undoEmphasise.push(function(a){return a.css({zIndex:d})})}})(this)(c);a.css({zIndex:"1001"});return a};b.prototype._undoEmphasise=[];b.prototype.deemphasiseTarget=function(){var a,c,d,b,f;a=this.targetFn();
f=this._undoEmphasise;d=0;for(b=f.length;d<b;d++)c=f[d],c(a);return a};b.prototype.position=null;b.prototype.positionAnnoElem=function(a){var c,d,b;null==a&&(a=this._annoElem);b=this.positionFn();c=this.targetFn();d=c.position();switch(b){case "top":case "bottom":a.css({left:d.left+"px"});break;case "center-top":case "center-bottom":a.css({left:d.left+(c.outerWidth()/2-a.outerWidth()/2)+"px"});break;case "left":case "right":a.css({top:d.top+"px"});break;case "center-left":case "center-right":a.css({top:d.top+
(c.outerHeight()/2-a.outerHeight()/2)+"px"})}switch(b){case "top":case "center-top":a.css({top:d.top-a.outerHeight()+"px"});break;case "bottom":case "center-bottom":a.css({top:d.top+c.outerHeight()+"px"});break;case "left":case "center-left":a.css({left:d.left-a.outerWidth()+"px"});break;case "right":case "center-right":a.css({left:d.left+c.outerWidth()+"px"});break;default:null!=b.left||null!=b.right||null!=b.top||null!=b.bottom?a.css(b):console.error("Unrecognised position: '"+b+"'")}return a};
b.prototype.positionFn=function(){var a,c,d,k,f,g,n,t,m;if(null!=this.position)return this.position;if(null!=this._annoElem)return a=this.targetFn(),c=a.closest(":scrollable"),0===c.length&&(c=e("body")),f=a.offset(),k=c.offset(),d=f.left-k.left,k=f.top-k.top,g=f=void 0,f=d+a.outerWidth(),g=k+a.outerHeight(),a=c.width()||c.width(),c=c.height()||c.height(),n=this._annoElem.outerWidth(),t=this._annoElem.outerHeight(),m=[],n>d&&(m=m.concat(["left","center-left"])),t>k&&(m=m.concat(["top","center-top"])),
n+f>a&&(m=m.concat(["right","center-right"])),t+g>c&&(m=m.concat(["bottom","center-bottom"])),d=b.preferredPositions.filter(function(a){return 0>r.call(m,a)}),0===d.length?console.error("Anno couldn't guess a position for '"+this.target+"'. Please supply one in the constructor."):console.warn("Anno: guessing position:'"+d[0]+"' for "+("'"+this.target+"'. Possible Anno.preferredPositions: ["+d+"].")),this.position=d[0]};b.preferredPositions="bottom right left top center-bottom center-right center-left center-top".split(" ");
b.prototype.arrowPositionFn=function(){var a,b;if(null!=this.arrowPosition)return this.arrowPosition;if("string"===typeof this.positionFn())return{top:"bottom","center-top":"center-bottom",left:"right","center-left":"center-right",right:"left","center-right":"center-left",bottom:"top","center-bottom":"center-top"}[this.positionFn()];a=parseInt(this.positionFn().left,10);b=parseInt(this.positionFn().top,10);a=Math.abs(a)>Math.abs(b)?0>a?"center-right":"center-left":0>b?"center-bottom":"center-top";
console.warn("Guessing arrowPosition:'"+a+"' for "+this.target+". Include this in your constructor for consistency.");return a};b.prototype.arrowPosition=null;b.prototype.buttons=[{}];b.prototype.buttonsFn=function(){return this.buttons instanceof Array?this.buttons.map(function(a){return new p(a)}):[new p(this.buttons)]};b.prototype.buttonsElem=function(){var a;return e("<div class='anno-btn-container'></div>").append(function(){var b,d,k,f;k=this.buttonsFn();f=[];b=0;for(d=k.length;b<d;b++)a=k[b],
f.push(a.buttonElem(this));return f}.call(this))};return b}();l.AnnoButton=p=function(){function b(a){var b,d;for(b in a)d=a[b],this[b]=d}b.prototype.buttonElem=function(a){return e("<button class='anno-btn'></button>").html(this.textFn(a)).addClass(this.className).click(function(b){return function(d){return b.click.call(a,a,d)}}(this))};b.prototype.textFn=function(a){return null!=this.text?this.text:null!=a._chainNext?"Next":"Done"};b.prototype.text=null;b.prototype.className="";b.prototype.click=
function(a,b){return null!=a._chainNext?a.switchToChainNext():a.hide()};b.NextButton=new b({text:"Next",click:function(){return this.switchToChainNext()}});b.DoneButton=new b({text:"Done",click:function(){return this.hide()}});b.BackButton=new b({text:"Back",className:"anno-btn-low-importance",click:function(){return this.switchToChainPrev()}});return b}()},function(q,l,h){q.exports=r},function(q,l,h){(function(e){var p={vertical:{x:!1,y:!0},horizontal:{x:!0,y:!1},both:{x:!0,y:!0},x:{x:!0,y:!1},y:{x:!1,
y:!0}},l={duration:"fast",direction:"both"},b=/^(?:html)$/i,a=function(a){var c=e(window),f=b.test(a[0].nodeName),g;if(f)g={top:0,left:0,bottom:0,right:0};else{var n=a[0],l;l=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(n,null):n.currentStyle;var m=document.defaultView&&document.defaultView.getComputedStyle?!0:!1;g=parseFloat(m?l.borderTopWidth:e.css(n,"borderTopWidth"))||0;var p=parseFloat(m?l.borderLeftWidth:e.css(n,"borderLeftWidth"))||0,h=parseFloat(m?
l.borderBottomWidth:e.css(n,"borderBottomWidth"))||0,n=parseFloat(m?l.borderRightWidth:e.css(n,"borderRightWidth"))||0;g={top:g,left:p,bottom:h,right:n,vertical:g+h,horizontal:p+n}}c={top:(f?c:a).scrollTop(),left:(f?c:a).scrollLeft()};p={right:f?0:a.innerWidth()-a[0].clientWidth,bottom:f?0:a.innerHeight()-a[0].clientHeight};h=a[0].getBoundingClientRect();return{border:g,scroll:c,scrollbar:p,rect:{top:f?0:h.top,left:f?0:h.left,bottom:f?a[0].clientHeight:h.bottom,right:f?a[0].clientWidth:h.right}}};
e.fn.extend({scrollintoview:function(d){d=e.extend({},l,d);d.direction=p["string"===typeof d.direction&&d.direction.toLowerCase()]||p.both;var c="";!0===d.direction.x&&(c="horizontal");!0===d.direction.y&&(c=c?"both":"vertical");var f=this.eq(0),g=f.closest(":scrollable("+c+")");if(0<g.length){var g=g.eq(0),n=a(f),c=a(g),f=n.rect.top-(c.rect.top+c.border.top),h=c.rect.bottom-c.border.bottom-c.scrollbar.bottom-n.rect.bottom,m=n.rect.left-(c.rect.left+c.border.left),n=c.rect.right-c.border.right-c.scrollbar.right-
n.rect.right,q={};!0===d.direction.y&&(0>f?q.scrollTop=c.scroll.top+f:0<f&&0>h&&(q.scrollTop=c.scroll.top+Math.min(f,-h)));!0===d.direction.x&&(0>m?q.scrollLeft=c.scroll.left+m:0<m&&0>n&&(q.scrollLeft=c.scroll.left+Math.min(m,-n)));e.isEmptyObject(q)?e.isFunction(d.complete)&&d.complete.call(g[0]):(b.test(g[0].nodeName)&&(g=e("html,body")),g.animate(q,d.duration).eq(0).queue(function(a){e.isFunction(d.complete)&&d.complete.call(g[0]);a()}))}return this}});var c={auto:!0,scroll:!0,visible:!1,hidden:!1};
e.extend(e.expr[":"],{scrollable:function(a,e,f,g){e=p["string"===typeof f[3]&&f[3].toLowerCase()]||p.both;f=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,null):a.currentStyle;var h=c[f.overflowX.toLowerCase()]||!1,l=c[f.overflowY.toLowerCase()]||!1,m=b.test(a.nodeName);if(!h&&!l&&!m)return!1;a={height:{scroll:a.scrollHeight,client:a.clientHeight},width:{scroll:a.scrollWidth,client:a.clientWidth},scrollableX:function(){return(h||m)&&this.width.scroll>
this.width.client},scrollableY:function(){return(l||m)&&this.height.scroll>this.height.client}};return e.y&&a.scrollableY()||e.x&&a.scrollableX()}})})(jQuery)}])});